## This file is useful for local image builds to test packaging of the application.
## It will build the docker image and use it in tanden with the configurations laid out in the file when used with 
## the command ` docker-compose up --build `. 
##volume mapping and various other container resources.  The volume mapping below is accomplished
## by mapping the WSL /mnt/v as a mount mpoint for a windows share on another machine (harry's test iSpy)
## In between builds, you can tear down the image and all artifacts created in this file using:
## ` docker-compose down --volumes `
##
## NOTE: you will need Docker Desktop or some provider/configuration of WSL to provide docker/container services

version: "3.9"


services:
  rainman-multi:
    # image: rainman
    container_name: rainman-multi
    build:
      context: .
      # target: debug

    # volumes:
    #   - /mnt/image_storage_d:/app/image_storages:rw
    # # environment:
    # #   - DEBUG=0
    volumes:
      # - type: volume
      #   source: image_storage_d
      #   target: /app/image_storage
      #   volume:
      #     nocopy: true
      - type: bind
        source: /mnt/x
        target: /app/image_storage
    entrypoint: [ "python3", "countcars.py" ]
    networks:
      - rainman
    
    # depends_on: 
    #   - image_storage_d

volumes:
  image_storage_d:
    driver_opts:
      type: none
      device: /mnt/x/

    # driver_opts:
    #   type: none
    #   device: /mnt/_image_storage_d

#   image_storage:































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#     driver_opts: 































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       type: cifs































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       device: //10.12.12.8/video/AgentVMS/Video































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       o: "user=acctcom\\sfarmer,password=July2020!"































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































# volumes:































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#   image_storage:































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#     driver_opts:































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       type: nfs































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       o: addr=10.12.12.8,rw































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#       device: :/video/
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































networks:
  rainman:
    name: rainman
    # volumes:
    #   container_storage:
    #     driver_opts:
    #       type: nfs
    #       o: addr=192.168.2.207,rw
    #       device: :/volume3/container-storage/


    ## ORIGNAL SET UP      
    # services:
    #   api:
    #     container_name: mlapi-pixel2
    #     build:
    #       context: .
    #       dockerfile: Dockerfile
    #     image: mlapi-pixel
    #     ports: 
    #       - "5010:5010"
    #     volumes:
    #       - container_storage:/app/container_storage
    #     environment: 
    #       - FLASK_DEBUG=1




    # depends_on: 
    #    - volumes

    # nfs-music:
    #   driver_opts:
    #     type: nfs
    #     o: addr=192.168.2.207,ro
    #     device: :/volume3/Music/


    # services:
    #   mlapi:
    #     container_name: mlapi
    #     restart: always
    #     build: ./mlapi
    #     ports:
    #       - "5010:5010"
    #     command: gunicorn mlapi:app

    #   nginx:
    #     container_name: nginx
    #     restart: always
    #     build: ./nginx
    #     ports:
    #       - "8080:8080"
    #     depends_on:
    #       - mlapi


    # volumes:
    #   data:    
    #   container_storage:    
    #       drive_opts:
    #       type: nfs4
    #       o: addr=192.168.2.207,nfsvers=4.1,rsize=8192,wsize=8192,hard,timeo=600,retrans=2
    #       device: ":/volume3/container-storage"
